local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

local gui = Instance.new("ScreenGui")
gui.Parent = player:WaitForChild("PlayerGui")

local button = Instance.new("TextButton")
button.Parent = gui
button.Size = UDim2.new(0, 150, 0, 50)
button.Position = UDim2.new(0.85, 0, 0.05, 0)
button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
button.TextColor3 = Color3.fromRGB(255, 255, 255)
button.Text = "T·∫Øt Ghim Camera"
button.Font = Enum.Font.SourceSansBold
button.TextSize = 20
button.AutoButtonColor = true

local isAiming = true  -- Bi·∫øn l∆∞u tr·∫°ng th√°i ghim camera

-- üèπ H√†m t√¨m ng∆∞·ªùi ch∆°i g·∫ßn nh·∫•t
local function getNearestPlayer()
    local closestPlayer = nil
    local closestDistance = math.huge

    for _, otherPlayer in pairs(Players:GetPlayers()) do
        if otherPlayer ~= player and otherPlayer.Character and otherPlayer.Character:FindFirstChild("Head") then
            local head = otherPlayer.Character.Head
            local distance = (head.Position - camera.CFrame.Position).Magnitude
            
            if distance < closestDistance then
                closestDistance = distance
                closestPlayer = otherPlayer
            end
        end
    end

    return closestPlayer
end

-- üîÑ C·∫≠p nh·∫≠t Camera theo ng∆∞·ªùi ch∆°i g·∫ßn nh·∫•t
local function updateCamera()
    if not isAiming then return end  -- N·∫øu ghim b·ªã t·∫Øt, kh√¥ng l√†m g√¨ c·∫£

    local targetPlayer = getNearestPlayer()
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("Head") then
        local head = targetPlayer.Character.Head
        camera.CameraSubject = head
        camera.CFrame = CFrame.new(camera.CFrame.Position, head.Position)
    end
end

-- üöÄ Khi v√†o game, ghim v√†o ng∆∞·ªùi g·∫ßn nh·∫•t
task.wait(1)
updateCamera()

-- üéØ Li√™n t·ª•c c·∫≠p nh·∫≠t Camera
RunService.RenderStepped:Connect(updateCamera)

-- ‚ò†Ô∏è Khi ng∆∞·ªùi ch∆°i ch·∫øt, t·ª± ƒë·ªông ƒë·ªïi m·ª•c ti√™u
player.CharacterRemoving:Connect(function()
    task.wait(0.5)
    updateCamera()
end)

-- üéõÔ∏è X·ª≠ l√Ω n√∫t b·∫≠t/t·∫Øt ghim camera
button.MouseButton1Click:Connect(function()
    isAiming = not isAiming  -- ƒê·∫£o tr·∫°ng th√°i

    if isAiming then
        button.Text = "T·∫Øt Ghim Camera"
        updateCamera()  -- N·∫øu b·∫≠t l·∫°i, c·∫≠p nh·∫≠t ngay l·∫≠p t·ª©c
    else
        button.Text = "B·∫≠t Ghim Camera"
        camera.CameraSubject = player.Character and player.Character:FindFirstChild("Humanoid") or nil
    end
end)
